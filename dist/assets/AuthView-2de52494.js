import{_ as b,o as i,c as l,i as g,F as x,b as e,a as N,j as r,u as P,k as V,f as y,h as C,l as I,v as L,m as D,e as w,g as E,w as F,t as j,q as J,p as M,d as O}from"./index-e1daf5a8.js";import{_ as q,a as T}from"./hide-password-ece45b91.js";const U={name:"App",data(){return{isAdmin:!1}},created(){this.checkAdminStatus()},methods:{checkAdminStatus(){const o=JSON.parse(localStorage.getItem("user"));this.isAdmin=o&&o.isAdmin}}},R={key:0,class:"errorSection"},W=e("div",{class:"wrapper"},[e("div",{class:"errorBlock"},[e("h1",{class:"h1 errorBlock__title"},"Приветствую, админ!"),e("p",{class:"h4 errorBlock__subtitle"},"Можете проводить настройку сайта через навигационное меню.")])],-1),$=[W],z={key:1,class:"errorSection"},G=N('<div class="wrapper"><div class="errorBlock"><h1 class="h1 errorBlock__title">Вы вошли!</h1><p class="h4 errorBlock__subtitle">Можете продолжить использование сайта.</p><div class="buttonWrap center"><a href="/" class="btn btn_l">На главную</a></div></div></div>',1),H=[G];function K(o,t,d,s,c,u){return i(),l(x,null,[c.isAdmin?(i(),l("section",R,$)):g("",!0),c.isAdmin?g("",!0):(i(),l("section",z,H))],64)}const Q=b(U,[["render",K]]);const X={components:{AuthComp:Q},setup(){const o=r([]),t=r(!0),d=r(null),s=r(""),c=r(""),u=r(!1),p=r(!1),_=r(null);P(),r(!1);async function n(){try{t.value=!0;const a=await fetch("https://ec4cde03eba81a3e.mokky.dev/users"),h=await a.json();if(!a.ok)throw new Error(h.message||"Something went wrong");o.value=h}catch(a){d.value=a.message}finally{t.value=!1}}async function A(){try{let ge=function(){const S=JSON.parse(localStorage.getItem("user")),pe=a&&a.isAdmin};const a=localStorage.getItem("user"),h=s.value,v=c.value,f=await fetch(`https://ec4cde03eba81a3e.mokky.dev/users?email=${h}&pass=${v}`);if(f.ok)window.location.reload();else{const S=await f.json();throw new Error(S.message||"Something went wrong")}console.log(f);const m=await f.json();if(!f.ok)throw new Error(m.message||"Something went wrong");if(m.length>0&&m[0].email===s.value&&m[0].pass===c.value)localStorage.setItem("user",JSON.stringify(m[0])),localStorage.setItem("isLoggedIn","true"),u.value=!0,_.value=m[0],window.history.pushState({},"","/");else throw d.value="Неверный логин или пароль",new Error("Invalid email or password")}catch(a){d.value=a.message}}V(()=>{const a=localStorage.getItem("user"),v=localStorage.getItem("isLoggedIn")==="true";a&&v?(_.value=JSON.parse(a),u.value=!0):(_.value=null,u.value=!1)});function B(){p.value=!p.value}return{data:o,loading:t,error:d,email:s,pass:c,isLoggedIn:u,showPassword:p,user:_,login:A,togglePassword:B,fetchData:n}}},k=o=>(M("data-v-392f14cc"),o=o(),O(),o),Y={class:"pageContent"},Z={class:"section section_noPadT"},ee={class:"wrapper"},se={key:0,class:"crumbs"},te=k(()=>e("span",null,[e("span",null,[e("a",{href:"/"},"Главная")]),w(" / "),e("span",null,"Вход")],-1)),oe=[te],ae=k(()=>e("h1",{class:"h3 section__title textCenter"},"Вход",-1)),ne={class:"inputs"},re={class:"input"},ie={class:"input input_pass"},ce=["type"],le={class:"input__icon"},de=k(()=>e("button",{type:"submit",class:"btn btn_full regForm__submit"},"Войти",-1)),ue={class:"regForm__p"},_e={key:0,class:"error-message"};function me(o,t,d,s,c,u){const p=y("router-link"),_=y("auth-comp");return i(),l("main",Y,[e("section",Z,[e("div",ee,[o.isAdmin?g("",!0):(i(),l("div",se,oe)),s.isLoggedIn?g("",!0):(i(),l("form",{key:1,action:"#",class:"regForm",onSubmit:t[4]||(t[4]=C((...n)=>s.login&&s.login(...n),["prevent"]))},[ae,e("div",ne,[e("div",re,[I(e("input",{type:"email",name:"mail",autocomplete:"off",placeholder:"Электронная почта","onUpdate:modelValue":t[0]||(t[0]=n=>s.email=n),required:""},null,512),[[L,s.email]])]),e("div",ie,[I(e("input",{type:s.showPassword?"text":"pass",name:"pass",placeholder:"Пароль",autocomplete:"off","onUpdate:modelValue":t[1]||(t[1]=n=>s.pass=n),required:""},null,8,ce),[[D,s.pass]]),e("div",le,[e("img",{src:q,alt:"",class:"show",title:"Показать пароль",onClick:t[2]||(t[2]=(...n)=>s.togglePassword&&s.togglePassword(...n))}),e("img",{src:T,alt:"",class:"hide",title:"Скрыть пароль",onClick:t[3]||(t[3]=(...n)=>s.togglePassword&&s.togglePassword(...n))})])]),de,e("p",ue,[w(" Впервые у нас? "),E(p,{to:"/register"},{default:F(()=>[w("Зарегистрироваться")]),_:1})]),s.error?(i(),l("div",_e,j(s.error),1)):g("",!0)])],32)),s.isLoggedIn?(i(),J(_,{key:2})):g("",!0)])])])}const ve=b(X,[["render",me],["__scopeId","data-v-392f14cc"]]);export{ve as default};
