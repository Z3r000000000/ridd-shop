import{_ as S,j as p,o as l,c as r,b as s,l as c,v as h,x as w,F as _,r as y,t as u,h as T,p as A,d as N,g as f,w as v,i as I,y as b,q as C}from"./index-e1daf5a8.js";const j={setup(){const t=p(""),e=p(""),a=p(0),d=p(0),i=p([]);async function n(){try{const m=await fetch("https://ec4cde03eba81a3e.mokky.dev/category");i.value=await m.json()}catch(m){console.error("Ошибка получения категорий:",m)}}async function o(){try{const m=await fetch("https://ec4cde03eba81a3e.mokky.dev/items",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:t.value,image:e.value,price:a.value,categoryId:d.value})});if(!m.ok)throw new Error(await m.json());t.value="",e.value="",a.value=0,d.value=0}catch(m){console.error("Ошибка при создании товара:",m)}}return n(),{title:t,image:e,price:a,categoryId:d,categories:i,createItem:o}}},g=t=>(A("data-v-ac1871f0"),t=t(),N(),t),L={class:"main-block"},O=g(()=>s("h1",null,"Добавить новый товар",-1)),q=g(()=>s("label",{for:"title"},"Название:",-1)),B=g(()=>s("label",{for:"image"},"URL картинки:",-1)),R={style:{"margin-bottom":"20px"}},D=g(()=>s("label",{for:"price"},"Цена:",-1)),J={id:"cat"},P=g(()=>s("label",{for:"category"},"Категория:",-1)),F=["value"],H=g(()=>s("button",{class:"btn btn_s btn_full",type:"submit"},"Добавить",-1));function $(t,e,a,d,i,n){return l(),r("div",L,[s("form",{onSubmit:e[4]||(e[4]=T((...o)=>d.createItem&&d.createItem(...o),["prevent"]))},[O,s("div",null,[q,c(s("input",{id:"title","onUpdate:modelValue":e[0]||(e[0]=o=>d.title=o),type:"text",required:""},null,512),[[h,d.title]])]),s("div",null,[B,c(s("input",{id:"image","onUpdate:modelValue":e[1]||(e[1]=o=>d.image=o),type:"text",required:""},null,512),[[h,d.image]])]),s("div",R,[D,c(s("input",{id:"price","onUpdate:modelValue":e[2]||(e[2]=o=>d.price=o),type:"number",required:""},null,512),[[h,d.price]])]),s("div",J,[P,c(s("select",{id:"category","onUpdate:modelValue":e[3]||(e[3]=o=>d.categoryId=o),required:""},[(l(!0),r(_,null,y(d.categories,o=>(l(),r("option",{key:o.id,value:o.id},u(o.name),9,F))),128))],512),[[w,d.categoryId]])]),H],32)])}const V=S(j,[["render",$],["__scopeId","data-v-ac1871f0"]]);const z={name:"AddCategory",data(){return{categoryName:"",categoryImage:""}},methods:{addCategory(){fetch("https://ec4cde03eba81a3e.mokky.dev/category",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:this.categoryName,image:this.categoryImage})}).then(t=>{t.ok?(this.categoryName="",this.categoryImage="",this.$emit("categoryAdded")):console.error("Error adding category:",t.status,t.statusText)}).catch(t=>{console.error("Error:",t)})}}},U=t=>(A("data-v-60174fcf"),t=t(),N(),t),G={class:"add-category"},K=U(()=>s("h3",null,"Добавить новую категорию",-1)),Q={class:"form-group"},W=U(()=>s("label",{for:"categoryName"},"Название категории:",-1)),X={class:"form-group"},Y=U(()=>s("label",{for:"categoryImage"},"Картинка категории URL:",-1)),Z=["disabled"];function ee(t,e,a,d,i,n){return l(),r("div",G,[K,s("div",Q,[W,c(s("input",{type:"text",id:"categoryName","onUpdate:modelValue":e[0]||(e[0]=o=>i.categoryName=o),placeholder:"Введите название категории"},null,512),[[h,i.categoryName]])]),s("div",X,[Y,c(s("input",{type:"text",id:"categoryImage","onUpdate:modelValue":e[1]||(e[1]=o=>i.categoryImage=o),placeholder:"Введите URL картинки"},null,512),[[h,i.categoryImage]])]),s("button",{onClick:e[2]||(e[2]=(...o)=>n.addCategory&&n.addCategory(...o)),disabled:!i.categoryName||!i.categoryImage},"Добавить",8,Z)])}const x=S(z,[["render",ee],["__scopeId","data-v-60174fcf"]]);const te={name:"App",data(){return{items:[],categories:[],showModal:!1,editedItem:null,selectedCategory:"all",filteredItems:[]}},watch:{items(){this.filterItems()}},mounted(){this.fetchItems(),this.fetchCategories()},methods:{fetchItems(){fetch("https://ec4cde03eba81a3e.mokky.dev/items").then(t=>t.json()).then(t=>{this.items=t}).catch(t=>{console.error("Ошибка при получении данных:",t)})},fetchCategories(){fetch("https://ec4cde03eba81a3e.mokky.dev/category").then(t=>t.json()).then(t=>this.categories=t)},showEditModal(t){this.editedItem={id:t.id,title:t.title,image:t.image,price:t.price,categoryId:t.categoryId},this.showModal=!0},closeModal(){this.showModal=!1,this.editedItem=null},filterItems(){this.selectedCategory==="all"?this.filteredItems=this.items:this.filteredItems=this.items.filter(t=>t.categoryId===this.selectedCategory)},async saveItem(t){try{const e=await fetch(`https://ec4cde03eba81a3e.mokky.dev/items/${t.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:t.title,image:t.image,price:t.price,categoryId:t.categoryId})});if(e.ok){const a=await e.json(),d=this.items.findIndex(i=>i.id===a.id);d!==-1?this.items.splice(d,1,a):this.items.push(a),this.filterItems(),this.closeModal()}else console.error("Error updating item:",e.status,e.statusText)}catch(e){console.error("Error:",e)}},async deleteItem(t){try{const e=this.items[t],a=await fetch(`https://ec4cde03eba81a3e.mokky.dev/items/${e.id}`,{method:"DELETE"});a.ok?(this.items.splice(t,1),this.filterItems()):console.error("Error deleting item:",a.status,a.statusText)}catch(e){console.error("Error:",e)}},getCategoryName(t){const e=this.categories.find(a=>a.id===t);return e?e.name:"Неизвестная категория"}}},k=t=>(A("data-v-e06b521d"),t=t(),N(),t),oe={id:"sus"},se={class:"category-filter"},ie=k(()=>s("label",{for:"category-select"},"Фильтр по категории:",-1)),de=k(()=>s("option",{value:"all"},"Все категории",-1)),ae=["value"],le={key:0,class:"shop-item-List"},re={class:"shop-item-info"},ne=["src"],ce={class:"item-actions"},me=["onClick"],he=["onClick"],ue={key:1,class:"container"},ge=k(()=>s("h1",{class:"h1 errorBlock__title center"},"Таких заказов нет.",-1)),pe=[ge],_e={key:0,class:"modal"},ye={class:"modal-content"},fe=k(()=>s("h2",null,"Редактирование товара",-1)),ve=["value"];function Ie(t,e,a,d,i,n){return l(),r("div",oe,[s("div",se,[ie,c(s("select",{id:"category-select","onUpdate:modelValue":e[0]||(e[0]=o=>i.selectedCategory=o),onChange:e[1]||(e[1]=(...o)=>n.filterItems&&n.filterItems(...o))},[de,(l(!0),r(_,null,y(i.categories,o=>(l(),r("option",{key:o.id,value:o.id},u(o.name),9,ae))),128))],544),[[w,i.selectedCategory]])]),i.filteredItems.length>0?(l(),r("div",le,[(l(!0),r(_,null,y(i.filteredItems,(o,m)=>(l(),r("div",{key:o.id,class:"shop-item"},[s("div",re,[s("img",{src:o.image,class:"item-image"},null,8,ne),s("h3",null,u(o.title),1),s("p",null,u(o.price)+" руб.",1),s("p",null,"Категория: "+u(n.getCategoryName(o.categoryId)),1)]),s("div",ce,[s("button",{class:"",onClick:M=>n.showEditModal(o)},"Изменить",8,me),s("button",{class:"",onClick:M=>n.deleteItem(m)},"Удалить",8,he)])]))),128))])):(l(),r("div",ue,pe)),f(b,{name:"modal"},{default:v(()=>[i.showModal&&i.editedItem?(l(),r("div",_e,[s("div",ye,[s("span",{class:"close-button",onClick:e[2]||(e[2]=(...o)=>n.closeModal&&n.closeModal(...o))},"×"),fe,c(s("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>i.editedItem.title=o),placeholder:"Название"},null,512),[[h,i.editedItem.title]]),c(s("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>i.editedItem.image=o),placeholder:"URL изображения"},null,512),[[h,i.editedItem.image]]),c(s("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>i.editedItem.price=o),type:"number",placeholder:"Цена"},null,512),[[h,i.editedItem.price]]),c(s("select",{class:"sel","onUpdate:modelValue":e[6]||(e[6]=o=>i.editedItem.categoryId=o)},[(l(!0),r(_,null,y(i.categories,o=>(l(),r("option",{value:o.id,key:o.id},u(o.name),9,ve))),128))],512),[[w,i.editedItem.categoryId]]),s("button",{class:"cuc",onClick:e[7]||(e[7]=o=>n.saveItem(i.editedItem))},"Сохранить")])])):I("",!0)]),_:1})])}const E=S(te,[["render",Ie],["__scopeId","data-v-e06b521d"]]);const be={id:"app"},ke={class:"rar"},Ce={class:"shop-toggle"},we={name:"App",components:{AddItems:V,AddCategory:x,ItemList:E},data(){return{showShopAdd:!1,showCategoryAdd:!1}},methods:{toggleShop(){this.showCategoryAdd&&(this.showCategoryAdd=!1),this.showShopAdd=!this.showShopAdd},toggleCategory(){this.showShopAdd&&(this.showShopAdd=!1),this.showCategoryAdd=!this.showCategoryAdd}}},Ae=Object.assign(we,{setup(t){return(e,a)=>(l(),r("div",be,[s("div",ke,[s("nav",null,[s("div",Ce,[s("button",{class:"btn btn_s btn_full admin-btn",onClick:a[0]||(a[0]=(...d)=>e.toggleShop&&e.toggleShop(...d))},"Добавить товар"),s("button",{class:"btn btn_s btn_full admin-btn",onClick:a[1]||(a[1]=(...d)=>e.toggleCategory&&e.toggleCategory(...d))},"Добавить категорию")])]),f(b,{name:"scale-down"},{default:v(()=>[e.showShopAdd?(l(),C(V,{key:0})):I("",!0)]),_:1}),f(b,{name:"scale-down"},{default:v(()=>[e.showCategoryAdd?(l(),C(x,{key:0})):I("",!0)]),_:1}),f(b,{name:"slide-up-down"},{default:v(()=>[!e.showShopAdd&&!e.showCategoryAdd?(l(),C(E,{key:0})):I("",!0)]),_:1})])]))}});export{Ae as default};
